# contest 853 (2025-6-25)

## [problem C](https://codeforces.com/contest/1789/problem/C)

### 题目简述

给定一个长度为 $N$ 的互异数组，经过 $M$ 次单点修改操作，得到 $M+1$ 个版本的互异数组。
定义每对数组 $(A_i, A_j)$ 的价值为拼接后不同元素的个数，求所有合法对的价值总和。

其中 $1 \leq N , \ M \leq 2 \times 10^5$, 数组中的元素 $1 \leq a_i \leq N + M$。

### 思路

因为题目保证原始和通过修改得到的 $M + 1$ 个数组都是互异数组，所以我们不用考虑同数组内有重复数字的问题。

当数组两两拼接，一个数字 $x$ 可能存在于数组 $A_i$ 或存在于数组 $A_j$，亦可能同时存在于两个数组中，这三种情况对最终答案都是贡献 1。

所以，我们可以通过数组中的数字的角度解决问题。统计所有数字出现的次数，
因为是互异数组，这同样也代表着包含某个数字的数组有多少个。假设包含数字 $x$ 的数组有 $c_x$ 个，那不包含 $x$ 的数组就有 $M + 1 - c_x$ 个。

因为「包含数字 $x$ 的数组两两拼接」和「包含 $x$ 的数组与不包含 $x$ 的数组拼接」都同样对答案贡献 1，所以 $x$ 对答案的贡献可以计算为：

$$\frac{c_x(c_x - 1)}{2} + c_x \times (M + 1 - c_x)$$

第一项为在包含的数组内选两个拼接的组合数，第二项为从包含和不包含的数组中各选一个的组合数。

可以通过遍历 $x \in X$ 并累加贡献得到答案，其中 $X$ 是包含所有数组出现的数字的集合。
另外，在代码实现中，$x$ 的频次可以通过记录 $x$ 在哪次修改引入和在哪次修改去除计算得出。

